language: python
sudo: required
python:
  - "3.6.4"

services:
  - docker

install:
  - pip install mypy
  - pip install mypy_extensions
  - pip install xml2rfc
  - pip install typeguard
  - gem install --no-doc kramdown-rfc2629

jobs:
  include:
    - stage: build
      script:
        - make -C build test
    - stage: test
      name: run
      script: make run
    -
      name: checkspec
      script: make check
    -
      name: test typechecked
      script: make test
    - stage: compilers
      name: ocaml compiler
      install: skip
      script:
        - docker run -v $PWD:/home/worker/hacspec --rm -ti franziskus/hacspec:0.2 /home/worker/hacspec/docker/travis-compiler/run.sh
    - stage: docs
      script:
        - make -C rfc

stages:
  - compilers
  - build
  - docs
  - test
